{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://raw.githubusercontent.com/studiowebux/restcli/main/http-request.schema.json",
  "title": "HTTP Request File",
  "description": "Schema for HTTP request files in YAML or JSON format",
  "oneOf": [
    {
      "$ref": "#/definitions/SingleRequest"
    },
    {
      "$ref": "#/definitions/MultipleRequests"
    }
  ],
  "definitions": {
    "SingleRequest": {
      "type": "object",
      "required": ["method", "url"],
      "properties": {
        "name": {
          "type": "string",
          "description": "Optional name for the request"
        },
        "method": {
          "type": "string",
          "enum": ["GET", "POST", "PUT", "DELETE", "PATCH", "HEAD", "OPTIONS"],
          "description": "HTTP method"
        },
        "url": {
          "type": "string",
          "description": "Request URL (can include {{variables}})"
        },
        "headers": {
          "type": "object",
          "additionalProperties": {
            "type": "string"
          },
          "description": "HTTP headers"
        },
        "body": {
          "type": "string",
          "description": "Request body (for POST, PUT, PATCH)"
        },
        "filter": {
          "type": "string",
          "description": "Optional JMESPath filter expression to narrow response results"
        },
        "query": {
          "type": "string",
          "description": "Optional JMESPath query or $(bash command) to transform response"
        },
        "tls": {
          "$ref": "#/definitions/TLSConfig",
          "description": "Optional TLS/mTLS configuration for secure connections"
        },
        "documentation": {
          "$ref": "#/definitions/Documentation",
          "description": "Optional documentation for the request"
        }
      },
      "additionalProperties": false
    },
    "TLSConfig": {
      "type": "object",
      "properties": {
        "certFile": {
          "type": "string",
          "description": "Path to client certificate file (PEM format)"
        },
        "keyFile": {
          "type": "string",
          "description": "Path to client private key file (PEM format)"
        },
        "caFile": {
          "type": "string",
          "description": "Path to CA certificate file for server verification (PEM format)"
        },
        "insecureSkipVerify": {
          "type": "boolean",
          "description": "Skip server certificate verification (insecure, for testing only)",
          "default": false
        }
      },
      "additionalProperties": false
    },
    "Documentation": {
      "type": "object",
      "properties": {
        "description": {
          "type": "string",
          "description": "Description of what the endpoint does"
        },
        "tags": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Tags/categories for organizing endpoints"
        },
        "parameters": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/Parameter"
          },
          "description": "Request parameters"
        },
        "responses": {
          "type": "array",
          "items": {
            "oneOf": [
              {
                "$ref": "#/definitions/Response"
              },
              {
                "type": "object",
                "additionalProperties": {
                  "type": "string"
                },
                "description": "Shorthand: {\"200\": \"Success\"}"
              }
            ]
          },
          "description": "Expected responses"
        }
      },
      "additionalProperties": false
    },
    "Parameter": {
      "type": "object",
      "required": ["name", "type"],
      "properties": {
        "name": {
          "type": "string",
          "description": "Parameter name"
        },
        "type": {
          "type": "string",
          "description": "Parameter type (string, number, boolean, object, array)"
        },
        "required": {
          "type": "boolean",
          "description": "Whether the parameter is required",
          "default": false
        },
        "deprecated": {
          "type": "boolean",
          "description": "Whether the parameter is deprecated",
          "default": false
        },
        "description": {
          "type": "string",
          "description": "Parameter description"
        },
        "example": {
          "type": "string",
          "description": "Example value for the parameter"
        }
      },
      "additionalProperties": false
    },
    "ResponseField": {
      "type": "object",
      "required": ["name", "type"],
      "properties": {
        "name": {
          "type": "string",
          "description": "Field name"
        },
        "type": {
          "type": "string",
          "description": "Field type (string, number, boolean, object, array, etc.)"
        },
        "required": {
          "type": "boolean",
          "description": "Whether the field is required",
          "default": false
        },
        "deprecated": {
          "type": "boolean",
          "description": "Whether the field is deprecated",
          "default": false
        },
        "description": {
          "type": "string",
          "description": "Field description"
        },
        "example": {
          "type": "string",
          "description": "Example value for the field"
        }
      },
      "additionalProperties": false
    },
    "Response": {
      "type": "object",
      "required": ["code", "description"],
      "properties": {
        "code": {
          "type": "string",
          "description": "HTTP status code",
          "pattern": "^[1-5][0-9]{2}$"
        },
        "description": {
          "type": "string",
          "description": "Response description"
        },
        "contentType": {
          "type": "string",
          "description": "Response content type (e.g., application/json)"
        },
        "fields": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/ResponseField"
          },
          "description": "Response body fields/schema"
        },
        "example": {
          "type": "string",
          "description": "Complete response example"
        }
      },
      "additionalProperties": false
    },
    "MultipleRequests": {
      "type": "object",
      "required": ["requests"],
      "properties": {
        "requests": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/SingleRequest"
          },
          "minItems": 1,
          "description": "Array of HTTP requests"
        }
      },
      "additionalProperties": false
    }
  }
}
